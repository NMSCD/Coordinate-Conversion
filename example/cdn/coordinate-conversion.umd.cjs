(function(a,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(a=typeof globalThis<"u"?globalThis:a||self,s(a.nmscdCoordinateConversion={}))})(this,function(a){"use strict";const s={generic:"Validation failed",atleast1InputIsRequired:"You need to pass in at least 1 input",cannotBeNull:e=>`${e} cannot be null`,unexpectedValue:(e,t,n)=>`${e} is an unexpected value (${t}), expected values ${n.join(", ")}`,minLength:e=>`Minimum length required is ${e}`,maxLength:e=>`Text is too long! Maximum length allowed is ${e}`,minValue:(e,t)=>`Minimum value for ${e} is ${t}`,maxValue:(e,t)=>`Maximum value for ${e} allowed is ${t}`},y=e=>()=>{var n;const t=e.inputValidator(e.input);if(t.isValid===!1)return{isSuccess:!1,value:{},errorMessage:t.errorMessage??s.generic};try{return{isSuccess:!0,errorMessage:"",value:e.converter(e.input)}}catch(o){return{isSuccess:!1,value:{},errorMessage:((n=o==null?void 0:o.toString)==null?void 0:n.call(o))??"Unknown exception occurred during conversion"}}},_=19,m=16,S=12,V=-1e4,C=1e4,T=0,L=10,R=1,U=10;function G(e){if(e.length!==_)return e;const t=2049,n=2047,o=129,r=127,l=parseInt(e.substring(0,4),16),c=parseInt(e.substring(5,9),16),d=parseInt(e.substring(10,14),16),f=parseInt(e.substring(15,19),16);let i=0,u=0,x=0;l<n?i=l+t:i=l-n,d<n?x=d+t:x=d-n,c<r?u=c+o:u=c-r;const I=["0",f.toString(16).toUpperCase().padStart(3,"0"),u.toString(16).toUpperCase().padStart(2,"0"),x.toString(16).toUpperCase().padStart(3,"0"),i.toString(16).toUpperCase().padStart(3,"0")].join("");return I.length===S?I:""}function O(e){const t=e.substring(9,12),n=e.substring(4,6),o=e.substring(6,9),r=e.substring(1,4),l=e.substring(0,1);return[t,n,o,r,l]}function b(e){if(e.length!==S)return{};const n=O(e).map(x=>parseInt(x,16)),o=n[0],r=n[1],l=n[2],c=n[3],d=n[4];let f,i,u;return o>2047?f=o-4096:f=o,l>2047?u=l-4096:u=l,r>127?i=r-256:i=r,{voxelX:f,voxelY:i,voxelZ:u,solarSystemIndex:c,planetIndex:d}}function Z(e){if(e.length!==_)return{};const t=G(e);return b(t)}const N=e=>{let t="";return e.code!=null?e.code.length===_?t=e.code:e.code.length===m&&(t=e.code.split("").flatMap((n,o)=>o!==m-1&&o%4===3?[n,":"]:[n]).join("")):e.groups!=null&&(t=e.groups.join(":")),t};var M=(e=>(e[e.Glyphs=0]="Glyphs",e[e.GalacticCoordinates=1]="GalacticCoordinates",e[e.VoxelCoordinates=2]="VoxelCoordinates",e))(M||{});const g=e=>t=>t!=null?{isValid:!0}:{isValid:!1,errorMessage:e??"Field shouldn't be empty"},z=(...e)=>t=>{for(const n of e){const o=n(t);if(o.isValid===!1)return o}return{isValid:!0}},$=(...e)=>t=>{const n=(t==null?void 0:t.length)??0;return e.includes(n)?{isValid:!0}:{isValid:!1,errorMessage:s.unexpectedValue("Length",n,e)}},q=e=>z(g(s.cannotBeNull(M.GalacticCoordinates.toString())),$(m,_))(e),j=e=>e.code==null&&e.groups==null?{isValid:!1,errorMessage:s.atleast1InputIsRequired}:e.code!=null?q(e.code):{isValid:!0},E=e=>({toGlyph:y({input:e,inputValidator:j,converter:t=>{const n=N(t),o=G(n);return{code:o,hexArray:o.split("")}}}),toVoxel:y({input:e,inputValidator:j,converter:t=>{const n=N(t);return Z(n)}})});function Y(e){if(e.length!==S)return"";const t=2049,n=2047,o=129,r=127,l=parseInt(e.substring(9,12),16),c=parseInt(e.substring(4,6),16),d=parseInt(e.substring(6,9),16),f=e.substring(1,4);let i=0,u=0,x=0;l>=t?i=l-t:i=l+n,d>=t?x=d-t:x=d+n,c>=o?u=c-o:u=c+r;const I=[i,u,x].map(J=>J.toString(16).toUpperCase().padStart(4,"0"));return I[3]=f.padStart(4,"0"),I.join(":")}function X({voxelX:e,voxelY:t,voxelZ:n,solarSystemIndex:o,planetIndex:r}){let l,c,d;e<0?l=e+4096:l=e,n<0?d=n+4096:d=n,t<0?c=t+256:c=t;const i=[o,c,d,l].map(v=>v.toString(16).toUpperCase()),u=i.splice(1,1)[0].padStart(2,"0"),x=i.map(v=>v.padStart(3,"0"));return x.splice(1,0,u),`${r}${x.join("")}`}function A(e){const t=X(e);return Y(t)}const B=e=>{let t="";return e.code!=null?t=e.code:e.hexArray!=null?t=e.hexArray.join(""):e.numberArray!=null&&(t=e.numberArray.map(n=>n.toString(16)).join("")),t},w=e=>z(g(s.cannotBeNull(M.Glyphs.toString())),$(12))(e),F=e=>e.code==null&&e.hexArray==null&&e.numberArray==null?{isValid:!1,errorMessage:s.atleast1InputIsRequired}:e.code!=null?w(e.code):{isValid:!0},D=e=>({toGalacticCoordinates:y({input:e,inputValidator:F,converter:t=>{const n=B(t),o=Y(n);return{code:o,groups:o.split(":")}}}),toVoxel:y({input:e,inputValidator:F,converter:t=>{const n=B(t);return b(n)}})}),h=(e,t)=>n=>(n??0)>=e?{isValid:!0}:{isValid:!1,errorMessage:s.minValue(t??"property",e)},p=(e,t)=>n=>(n??0)<e?{isValid:!0}:{isValid:!1,errorMessage:s.maxValue(t??"property",e)},H=e=>{const t=g(s.cannotBeNull("voxelInput"))(e);if(t.isValid===!1)return t;const n=[()=>g(s.cannotBeNull("voxelX"))(e.voxelX),()=>h(V,"voxelX")(e.voxelX),()=>p(C,"voxelX")(e.voxelX),()=>g(s.cannotBeNull("voxelY"))(e.voxelY),()=>h(V,"voxelY")(e.voxelY),()=>p(C,"voxelY")(e.voxelY),()=>g(s.cannotBeNull("voxelZ"))(e.voxelZ),()=>h(V,"voxelZ")(e.voxelZ),()=>p(C,"voxelZ")(e.voxelZ),()=>g(s.cannotBeNull("solarSystemIndex"))(e.solarSystemIndex),()=>h(T,"solarSystemIndex")(e.solarSystemIndex),()=>p(L,"solarSystemIndex")(e.solarSystemIndex),()=>g(s.cannotBeNull("planetIndex"))(e.planetIndex),()=>h(R,"planetIndex")(e.planetIndex),()=>p(U,"planetIndex")(e.planetIndex)];for(const o of n){const r=o();if(r.isValid!==!0)return r}return{isValid:!0}},k=e=>({toGlyph:y({input:e,inputValidator:H,converter:t=>{const n=X(t);return{code:n,hexArray:n.split("")}}}),toGalacticCoordinates:y({input:e,inputValidator:H,converter:t=>{const n=A(t);return{code:n,groups:n.split(":")}}})});a.GalacticCoordinate=E,a.PortalCode=D,a.VoxelCoordinate=k,a.coords2Glyphs=G,a.coords2XYZ=Z,a.glyphs2Coords=Y,a.glyphs2XYZ=b,a.xyz2Coords=A,a.xyz2Glyphs=X,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
